{% load static %}
<header class="bg-white/80 backdrop-blur-sm shadow-lg border-b border-gray-100 z-50">
  <div class="mx-auto container px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between">
      <!-- Site Logo -->
      <a href="/" class="flex items-center space-x-3 group">
        <img src="{% static 'favicon.png' %}" alt="ChapterOS Logo" class="w-10 h-10 rounded-lg shadow-md transition-transform duration-200">
        <span class="md:text-2xl text-xl font-bold bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent">ChapterOS</span>
      </a>

      <!-- Primary Navigation -->
      <nav class="md:flex md:items-center md:gap-12">
        <ul class="hidden md:flex items-center gap-6 text-sm">
          {% if user.is_authenticated %}
            <li><a href="/" class="nav-link text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200 flex items-center space-x-2"><i class="fas fa-home"></i><span>Home</span></a></li>
            <li><a href="/recruitments/" class="nav-link text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200 flex items-center space-x-2"><i class="fas fa-users"></i><span>Recruitments</span></a></li>
            <li><a href="/form_builder/" class="nav-link text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200 flex items-center space-x-2"><i class="fas fa-hammer"></i><span>Form Builder</span></a></li>
          {% endif %}
        </ul>
      </nav>

      <!-- User Menu -->
      <div class="hidden md:flex items-center space-x-4 ml-6">
        {% if user.is_authenticated %}
          <div class="relative group">
            <a href="#" class="flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-all duration-200">
              <img src="https://robohash.org/{{ user.id }}?size=32x32" alt="Profile Avatar" class="w-8 h-8 rounded-full">
              <i class="fas fa-chevron-down text-xs transition-transform duration-200 group-hover:rotate-180"></i>
            </a>
            <div class="absolute right-0 mt-0 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden group-hover:block">
              <a href="{% url 'users:dashboard' %}" class="flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:underline"><i class="fas fa-user-circle w-5"></i><span>View Profile</span></a>
              <a href="{% url 'users:profile' %}" class="flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:underline"><i class="fas fa-user-edit w-5"></i><span>Edit Profile</span></a>
              <div class="border-t border-gray-100 my-1"></div>
              <a href="{% url 'users:logout' %}" class="flex items-center space-x-3 px-4 py-2 text-sm text-red-700 hover:underline"><i class="fas fa-sign-out-alt w-5"></i><span>Logout</span></a>
            </div>
          </div>
          {% if 'Admin' in user_roles %}
            <a href="{% url 'users:admin_conference' %}" class="text-red-600 hover:text-red-700 hover:underline font-semibold transition-all duration-200">Admin</a>
          {% endif %}
        {% else %}
          <a href="{% url 'users:login' %}" class="text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200">Sign In</a>
          <a href="{% url 'users:register' %}" class="bg-blue-600 text-white hover:bg-blue-700 px-3 py-2 rounded-lg transition-all duration-200">Register</a>
        {% endif %}
      </div>

      <!-- Mobile menu toggle -->
      <a href="#" id="mobile-menu-btn" class="block md:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 ml-4">
        <i class="fas fa-bars text-gray-600"></i>
      </a>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="md:hidden mt-4 pb-4 hidden">
    <div class="flex flex-col space-y-2 px-4">
      <a href="/" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-home w-5"></i><span>Home</span></a>
      {% if user.is_authenticated %}
        <a href="/recruitments/" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-users w-5"></i><span>Recruitments</span></a>
        <a href="/form_builder/" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-hammer w-5"></i><span>Form Builder</span></a>
      {% endif %}
      <div class="border-t border-gray-200 my-2"></div>
      {% if user.is_authenticated %}
        <a href="{% url 'recruitments:recruitments_index' %}" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-tachometer-alt w-5"></i><span>Dashboard</span></a>
        <a href="{% url 'users:dashboard' %}" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-user-circle w-5"></i><span>View Profile</span></a>
        <a href="{% url 'users:profile' %}" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-user-edit w-5"></i><span>Edit Profile</span></a>
        {% if 'Admin' in user_roles %}
          <a href="{% url 'users:admin_conference' %}" class="flex items-center space-x-3 text-red-600 hover:text-red-700 hover:underline transition-all duration-200"><i class="fas fa-user-shield w-5"></i><span>Admin</span></a>
        {% endif %}
        <a href="{% url 'users:logout' %}" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-sign-out-alt w-5"></i><span>Logout</span></a>
      {% else %}
        <a href="{% url 'users:login' %}" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-sign-in-alt w-5"></i><span>Sign In</span></a>
        <a href="{% url 'users:register' %}" class="flex items-center space-x-3 text-gray-600 hover:text-blue-600 hover:underline transition-all duration-200"><i class="fas fa-user-plus w-5"></i><span>Register</span></a>
      {% endif %}
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = mobileMenuBtn.querySelector('i');

    mobileMenuBtn.addEventListener('click', function(e) {
      e.preventDefault();
      mobileMenu.classList.toggle('hidden');
      menuIcon.className = mobileMenu.classList.contains('hidden') ? 'fas fa-bars text-gray-600' : 'fas fa-times text-gray-600';
    });

    document.addEventListener('click', function(event) {
      if (!mobileMenuBtn.contains(event.target) && !mobileMenu.contains(event.target)) {
        mobileMenu.classList.add('hidden');
        menuIcon.className = 'fas fa-bars text-gray-600';
      }
    });

    const currentPath = window.location.pathname;
    document.querySelectorAll('.nav-link, #mobile-menu a').forEach(link => {
      const linkPath = link.getAttribute('href');
      if (linkPath && (linkPath === currentPath || (currentPath.startsWith(linkPath) && linkPath !== '/'))) {
        link.classList.add('text-blue-600', 'underline');
        link.classList.remove('text-gray-600');
      }
    });
  });
</script>
